<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pallet Weight Calculator & Exporter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container">
        <div>
            <h1>Pallet Calculator</h1>
            <p class="subtitle">Real-time weight suggestions and XLSX exporter.</p>
        </div>

        <div class="card">
            <h2>Chunk Management</h2>
            <div class="chunk-navigation">
                <button id="prev-chunk-btn">&larr; Previous</button>
                <span id="chunk-status">Chunk 1</span>
                <button id="next-chunk-btn">Next &rarr;</button>
            </div>
            <button id="archive-button">Archive Chunk & Start New</button>
        </div>

        <div id="summary-card" class="card sticky-summary">
            <div id="status-message" class="status-message"></div>
            <div class="metrics-grid">
                <div class="metric">
                    <div class="label">Total Gross Wt.</div>
                    <div id="total-gross-weight" class="value">0</div>
                </div>
                <div class="metric">
                    <div class="label">Remaining Wt.</div>
                    <div id="remaining-weight" class="value">0</div>
                </div>
                <div class="metric">
                    <div class="label">Suggested Next</div>
                    <div id="suggested-weight" class="value">0</div>
                </div>
            </div>
        </div>

        <button id="toggle-summary-btn" title="Show/Hide Calculation Overlay">ðŸ”½</button>

        <div class="card">
            <h2>Configuration</h2>
            <div class="form-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                <div class="input-group">
                    <label for="company-name">Company Name</label>
                    <select id="company-name">
                        <option value="TONG HONG TANNERY (VIET NAM) JOINT STOCK COMPANY">Tong Hong Tannery</option>
                        <option value="CAMBODIAN HUAMEI BIOTECHNOLOGY CO., LTD. â€‹â€‹">CHM</option>
                        <option value="THAI RONG EXPORT IMPORT TRADING INVESTMENT PRODUCTION COMPANY LIMITED">THAI RONG</option>
                        <option value="GLOBAL HIDE PROCESSING CO., LTD">Global Hide Processing</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="po-number">PO Number</label>
                    <input type="text" id="po-number" value="TH-250507">
                </div>
                <div class="input-group">
                    <label for="cbm-prefix">CBM Prefix</label>
                    <input type="text" id="cbm-prefix" value="2*1.1*">
                </div>
                <div class="input-group">
                    <label for="max-weight">Max Gross Weight (KG)</label>
                    <input type="text" inputmode="decimal" id="max-weight" value="25000">
                </div>
                <div class="input-group">
                    <label for="pallet-count">Pallets in this Chunk</label>
                    <div class="input-with-buttons">
                        <button type="button" class="count-button" id="dec-pallet-btn">âˆ’</button>
                        <input type="text" inputmode="numeric" id="pallet-count" value="12">
                        <button type="button" class="count-button" id="inc-pallet-btn">+</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="pallet-weight">Pallet Weight (KG)</label>
                    <input type="text" inputmode="decimal" id="pallet-weight" value="40">
                </div>
                <div class="input-group">
                    <label for="unit-price">Unit Price (per KG)</label>
                    <input type="text" inputmode="decimal" id="unit-price" value="2.50">
                </div>
                <div class="input-group">
                    <label for="input-mode">Input Mode</label>
                    <select id="input-mode">
                        <option value="gross-cbm">Gross Wt. & CBM Only</option>
                        <option value="sqft-pcs-gross-cbm">Sqft, Pcs, Gross, CBM</option>
                        <option value="pcs-gross-cbm">Pcs, Gross, CBM</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Pallet Details</h2>
            <div id="pallet-inputs-grid">
            </div>
        </div>

        <div class="card">
            <h2>Actions</h2>
            <div class="button-group">
                <button id="export-button">Export Shipping List</button>
                <button id="reset-button">Reset Current Chunk</button>
            </div>
            <div class="button-group" style="margin-top: 1rem;">
                <button id="clear-cache-button" style="background-color: #ffc107; color: #000;">Clear All Data</button>
                <button id="cache-info-button" style="background-color: #17a2b8;">Cache Info</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="reset-modal">
        <div class="modal-content">
            <h3>Confirm Reset</h3>
            <p>Are you sure you want to reset all data for the current chunk? This action cannot be undone.</p>
            <div class="modal-buttons">
                <button id="confirm-reset-btn">Yes, Reset</button>
                <button id="cancel-reset-btn">Cancel</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="clear-cache-modal">
        <div class="modal-content">
            <h3>Clear All Data</h3>
            <p>This will permanently delete all your saved chunks and reset the application. This action cannot be
                undone.</p>
            <div class="modal-buttons">
                <button id="confirm-clear-cache-btn" style="background-color: #dc3545;">Yes, Clear All</button>
                <button id="cancel-clear-cache-btn" style="background-color: #6c757d;">Cancel</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="cache-info-modal">
        <div class="modal-content">
            <h3>Cache Information</h3>
            <div id="cache-info-content">
                <p>Loading cache information...</p>
            </div>
            <div class="modal-buttons">
                <button id="close-cache-info-btn" style="background-color: #007bff;">Close</button>
            </div>
        </div>
    </div>

    <!-- JavaScript Modules -->
    <script src="js/utils.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/state.js"></script>
    <script src="js/dom-elements.js"></script>
    <script src="js/pallet-generator.js"></script>
    <script src="js/calculations.js"></script>
    <script src="js/excel-exporter.js"></script>
    <script src="js/event-handlers.js"></script>
    <script src="js/app.js"></script>
</body>

</html>